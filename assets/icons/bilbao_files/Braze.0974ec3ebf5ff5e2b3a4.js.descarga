!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("lodash"),require("ua-parser-js"));else if("function"==typeof define&&define.amd)define(["lodash","ua-parser-js"],t);else{var r="object"==typeof exports?t(require("lodash"),require("ua-parser-js")):t(e._,e.uaParser);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(self,((e,t)=>(()=>{var r={jOia:(e,t)=>{t.DEFAULT_LOCALE="en-US"},AFX1:e=>{e.exports={MOBILE_DEVICE:"mobile",TABLET_DEVICE:"tablet",DESKTOP_DEVICE:"desktop",IOS_OS_NAME:"iOS",ANDROID_OS_NAME:"Android"}},HFvH:(e,t,r)=>{const{MOBILE_DEVICE:n,TABLET_DEVICE:o,IOS_OS_NAME:i,ANDROID_OS_NAME:c}=r("AFX1");e.exports={isMobile:e=>e===n,isTouch:e=>[n,o].includes(e),isIos:e=>e===i,isAndroid:e=>e===c}},"1J0n":(e,t,r)=>{const{DEFAULT_LOCALE:n}=r("jOia");t.Q={locale:n,computedLocale:n,userId:0,country:"",countryCode:"",pageCtxId:"",isPro:!1,abTests:{},userAgent:"",knownCrawler:!1,csrfToken:"",browserLanguage:"",currency:"",pathParameters:{},queryParameters:{},userGuid:"",url:"",ip:"",referrer:"",organizationId:"",experience:{isBuyer:!1,isSeller:!1,isBusiness:!1,value:""},isMobile:!1,isTouch:!1,isIos:!1}},DOLe:e=>{e.exports={}},luq0:t=>{"use strict";t.exports=e},glLg:e=>{"use strict";e.exports=t}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;var i=n[e]={exports:{}};return r[e](i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{"use strict";o.r(i);const e=Symbol();class t{constructor(){this[e]=new Map}on(t,r){let n=this[e].get(t);n||(this[e].set(t,new Set),n=this[e].get(t)),n.add(r)}once(e,t){var r=this;const n=function(){r.off(e,n),t(...arguments)};this.on(e,n)}one(e,t){this.has(e)||this.on(e,t)}has(t){return this[e].has(t)}off(t,r){if(!this[e].has(t))return;if(void 0===r)return void this[e].delete(t);const n=this[e].get(t);n.delete(r),0===n.size&&this[e].delete(t)}emit(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];const i=this[e].get(t);i&&i.forEach((e=>{e(...n)}))}deferred(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Promise.resolve().then((()=>{this.emit(e,...r)}))}}const r=e=>"object"==typeof Fiverr&&"function"==typeof Fiverr[e]||void 0,n=(c="_logErrorToServer",function(){return r(c)&&Fiverr[c](...arguments)});var c;const s="object"==typeof window&&window.window===window&&window||"object"==typeof o.g&&o.g.global===o.g&&o.g||"object"==typeof self&&self.self===self&&self,a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;return e.split(".").reduce(((e,t)=>"object"==typeof e?e[t]:e),t)},u=["get","value","set","configurable","enumerable","writable"],d=["get","value"];function l(e,t){const r=Object.getOwnPropertyDescriptor(this.constructor.prototype,e),n=u.reduce(((n,o)=>{switch(typeof r[o]){case"undefined":break;case"function":d.includes(o)?n[o]=()=>t("".concat(e,"$").concat(o),r[o].bind(this)):n[o]=r[o];break;default:n[o]=r[o]}return n}),{});Object.defineProperty(this,e,n)}const f=new class{constructor(){!function(e){const t={};function r(e,r){return t[e]=e in t?t[e]:r()}for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];o.forEach((t=>l.call(e,t,r)))}(this,"node","browser","development","production","testing","plike","toString")}get node(){return"[object process]"===Object.prototype.toString.call(void 0!==s.process?s.process:0)}get browser(){return s.document&&"function"==typeof s.document.createElement||!this.node&&[typeof document,typeof window].every((e=>"undefined"!==e))}get development(){return this.toString().includes("dev")}get dev(){return this.development}get production(){return this.toString().includes("prod")}get prod(){return this.production}get testing(){return this.toString().includes("test")}get test(){return this.testing}get plike(){return this.toString().includes("like")}toString(){const e=this.node?a("process.env.NODE_ENV"):a("app.environment")||(e=>{if("undefined"==typeof document)return;const t=document.querySelector('meta[name="'.concat(e,'"]'));return t&&t.getAttribute("content")||void 0})("app_environment");return(e||"").toLowerCase()}},p=Symbol.for("SocketHandler"),g=Symbol.for("SocketSubscriptions"),y=Symbol.for("AsyncSubscriptionIdPromise"),b=Symbol.for("AsyncSubscriptionIdResolver"),v="open",h="close",m="message";s[g]=s[g]||new t,s[y]=s[y]||new Promise((e=>{s[b]=s[b]||e}));const w=function(){let{data:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e){try{e=JSON.parse(e)}catch(t){n("socketHandler","incomingHandler","unable to parse event: ".concat(e))}e&&"object"==typeof e&&e.eventType&&s[g].emit(e.eventType,e)}},O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;"string"==typeof t&&t.split(" ").forEach((t=>s[g][e](t,r)))},E={connect:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!s[p]&&f.browser?(s[p]=new WebSocket(e),s[b](t.payload.subscription),s[p].addEventListener(v,(()=>{s[p].addEventListener(m,w),E.send(t)})),s[p].addEventListener(h,(function r(){setTimeout((()=>{E.connect(e,t)}),1500),s[p].removeEventListener(h,r),s[p].removeEventListener(m,w)})),E):E},send:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f.browser&&1===s[p].readyState&&s[p].send(JSON.stringify(e)),E},on:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return O("on",...t)},once:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return O("once",...t)},off:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return O("off",...t)},getSubscriptionId:()=>s[y]},S=e=>{window.appboy&&e.custom_event_name&&(document.hidden?j.queue.push((()=>{window.appboy.logCustomEvent(e.custom_event_name,e.properties)})):window.appboy.logCustomEvent(e.custom_event_name,e.properties))},j={init(){this.queue=[],this.subscribeSocketHandler(),this.bindWindowFocusEvent()},bindWindowFocusEvent(){window.addEventListener("focus",(()=>{for(;this.queue.length>0;){this.queue.pop()()}}))},subscribeSocketHandler(){E.on("braze_custom_event",S)}};o("DOLe");const _=()=>{j.init()},A=Symbol.for("globalEventBus"),x=s[A]=s[A]||new t,I="OBS::LOGGER",D="debug",P="verbose",L="info",T="warn",C="error",B="critical",k=[D,P,L,T,C,B],R=k.reduce(((e,t)=>Object.assign(e,{[t]:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return x.deferred(I,{entity:e,enrichments:r,level:t})}})),{});Object.defineProperty(R,"force",{value:k.reduce(((e,t)=>Object.assign(e,{[t]:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return x.deferred(I,{entity:e,enrichments:r,level:t,force:true})}})),{})});const M=R,N="OBS::STATS",F=["count","time","gauge","set","histogram"],q=F.reduce(((e,t)=>Object.assign(e,{[t]:function(e,r,n){let{rate:o,tags:i,enforceRate:c}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object.entries({prefix:e,metric:r}).forEach(((e,t)=>{let[r,n]=e;if("string"!=typeof n||!n)throw new TypeError("Expected argument ".concat(t," (").concat(r,") to be a string. Instead got ").concat(typeof n," (").concat(n,")"))}));const s=[e,r].join(".");return x.deferred(N,{type:t,key:s,value:n,rate:o,tags:i,enforceRate:c})}})),{});Object.defineProperty(q,"prefix",{value:e=>F.reduce(((t,r)=>Object.assign(t,{[r]:q[r].bind(q,e)})),{})});const H=q,V=H.prefix("services.layout_server"),z=(V.time,V.count);var U=o("luq0"),G=o.n(U);function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const W=e=>{return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){Q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({type:e.type,name:e.name,created_at:new Date(e.createdAt).toISOString(),duration:e.duration||null,value:e.value||null},{context_id:(t=e.context).id,user_id:t.userId.toString(),country_code:t.countryCode,browser:t.browserName,locale:t.locale,currency:t.currency,platform:t.platform});var t},K=(e=>function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return x.deferred(e,{events:r})})("OBS::BIG_QUERY_MONICORE"),X="monicore",Y="mobile_web",$="web";class Z extends Error{constructor(e){super(e),this.name="ContextNotFoundError"}}const ee=Date.now(),te=window.performance&&window.performance.now?window.performance:{now:()=>Date.now()-ee,timeOrigin:ee};var re=o("glLg"),ne=o.n(re),oe=o("HFvH");const ie=Symbol(),ce=(e,t,r)=>{Object.defineProperty(e,t,{value:r,writable:!1,enumerable:!1})},se=e=>{if(e[ie])return e;if(!(e=>!!e&&(0,U.isObject)(e)&&!Array.isArray(e))(e))return M.error("FiverrContext computed mixin target is not valid, please contact platform team."),e;const{userAgent:t}=e,r=ne()(t),{device:{type:n},os:{name:o}}=r,i={isMobile:oe.isMobile(n),isTouch:oe.isTouch(n),isIos:oe.isIos(o),isAndroid:oe.isAndroid(o)};return ce(e,ie,!0),Object.entries(i).forEach((t=>{let[r,n]=t;return ce(e,r,n)})),e};var ae=o("1J0n");const ue=()=>{const e=G().get(window,"initialData.FiverrContext");return e?se(e):(M.error({message:"Browser context does not exist, please ensure the run time owner sets one on the window scope before using this API"}),ae.Q)},de=()=>{const{pageCtxId:e,userId:t,countryCode:r,locale:n,isMobile:o,currency:i}=ue();return{id:e||"",userId:t||"",countryCode:r||"",locale:n||"",currency:i||"",platform:o?Y:$}},le="event",fe="error",pe=[le,fe],ge="ADD_EVENT_ERROR",ye="ADD_ERROR_ERROR",be=()=>te.now()+(()=>{let e=te.timeOrigin;return"number"!=typeof e&&(e=te.timing&&te.timing.navigationStart),e})(),ve=e=>!(!(0,U.isUndefined)(e)&&!(0,U.isString)(e))||(M.error("Expected value to be a string. Instead got a ".concat(typeof e),{caughtBy:X,value:e}),!1),he=e=>!(!(0,U.isString)(e)||(0,U.isEmpty)(e))||(M.error("Expected name to be a string. Instead got a ".concat(typeof e),{caughtBy:X,name:e}),!1),me=()=>{H.count("monicore","context_not_found")},we=e=>(e=>{e.context.isKnownCrawler||K(W(e))})(e),Oe=(e,t)=>{try{return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:le;if(he(e))if(pe.includes(r)){ve(t)||(t=void 0);try{const n={name:e,value:t,type:r,createdAt:be(),context:de()};we(n)}catch(e){e instanceof Z?me():M.warn(e,{caughtBy:X,code:ge})}}else M.error('Expected "type" to be event or error. Instead got a '.concat(r),{caughtBy:X,code:ge})}(e,t,fe)}catch(e){M.warn(e,{caughtBy:X,code:ye})}};try{_()}catch(e){((e,t,r)=>{const n="Layout component: ".concat(t,", failed on entry: ").concat(r,"."),o="layout.CSR.".concat(t,".").concat(r);M.error(e instanceof Error?e:new Error(n),{description:n,componentName:t,entryName:r,package:"@fiverr-private/layout-sdk"}),Oe(o),z("layout_component.".concat(t,".error"))})(e,"Braze","Braze")}})(),i})()));
//# sourceMappingURL=Braze.0974ec3ebf5ff5e2b3a4.js.map